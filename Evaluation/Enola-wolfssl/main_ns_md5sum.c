#include <arm_cmse.h>
#include "RTE_Components.h"                        /* Component selection */
#include CMSIS_device_header
#include "Secure_Functions.h"     /* Secure Code Entry Points */
#include "enola-measurement.h"
#include "simple-crypto.h"
#include "hash.h"
#include "rsa.h"
#include "aes.h"


uint8_t key[] = {0x12, 0xc2, 0x5d, 0x66, 0x67, 0x66, 0x27, 0x68, 0x12, 0xc2, 0x5d, 0x66, 0x67, 0x66, 0x27, 0x68, 0x12, 0xc2, 0x5d, 0x66, 0x67, 0x66, 0x27, 0x68, 0x12, 0xc2, 0x5d, 0x66, 0x67, 0x66, 0x27, 0x68};

uint8_t plaintext[] = {0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c,
                         0x1a, 0x1b, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0xa, 0xb, 0x1c, 0x2d, 0xe, 0xf, 0x2d, 0x4c};

  uint8_t hash_out[16];

static uint32_t x;

int main (void)
{
    /* exercise some core register from Non Secure Mode */
  x = __get_MSP();
  x = __get_PSP();

  SystemCoreClockUpdate();
  
  /*MD5sum*/
  size_t len = 1024;

  wc_Md5Hash(plaintext, len, hash_out);
  print_occurence_trace();
}